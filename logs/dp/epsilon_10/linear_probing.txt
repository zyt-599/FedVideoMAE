(fedmae) marvin@MarvinsPC:/mnt/d/CSEC5709$ python -m FedVideomae_DP.train.fl_eval_linear --config configs/linear_probe_rwf2000.yaml
[LoRA] Injected 100 layers -> LoRALinear; samples: ['backbone.encoder.blocks.0.attn.q_proj', 'backbone.encoder.blocks.0.attn.k_proj', 'backbone.encoder.blocks.0.attn.v_proj', 'backbone.encoder.blocks.0.mlp.fc1', 'backbone.encoder.blocks.0.mlp.fc2', 'backbone.encoder.blocks.1.attn.q_proj', 'backbone.encoder.blocks.1.attn.k_proj', 'backbone.encoder.blocks.1.attn.v_proj'] ...; trainable params=3145728
Warning: Unexpected keys when loading pretrained weights: 3 keys
Loaded pretrained weights from FedVideomae_DP/runs/pretrain_rwf2000_epsilon_10/model_final.pth
Using weighted loss with class weights: [1.2, 1.3]

[Server] Round 1/20 | selected=['1']
[Client1] Final: loss=0.6764 acc=0.5000
[Server] Round 1 global metrics: loss=0.6764

[Server] Round 2/20 | selected=['1']
[Client1] Final: loss=0.9700 acc=0.5000
[Server] Round 2 global metrics: loss=0.9700

[Server] Round 3/20 | selected=['1']
[Client1] Final: loss=1.0272 acc=0.2500
[Server] Round 3 global metrics: loss=1.0272

[Server] Round 4/20 | selected=['1']
[Client1] Final: loss=0.0420 acc=1.0000
[Server] Round 4 global metrics: loss=0.0420

[Server] Round 5/20 | selected=['1']
[Client1] Final: loss=0.7535 acc=0.7500
[Server] Round 5 global metrics: loss=0.7535

[Server] Round 6/20 | selected=['1']
[Client1] Final: loss=0.0378 acc=1.0000
[Server] Round 6 global metrics: loss=0.0378

[Server] Round 7/20 | selected=['1']
[Client1] Final: loss=0.2088 acc=1.0000
[Server] Round 7 global metrics: loss=0.2088

[Server] Round 8/20 | selected=['1']
[Client1] Final: loss=1.6784 acc=0.2500
[Server] Round 8 global metrics: loss=1.6784

[Server] Round 9/20 | selected=['1']
[Client1] Final: loss=0.5115 acc=0.5000
[Server] Round 9 global metrics: loss=0.5115

[Server] Round 10/20 | selected=['1']
[Client1] Final: loss=0.3291 acc=1.0000
[Server] Round 10 global metrics: loss=0.3291

[Server] Round 11/20 | selected=['1']
[Client1] Final: loss=0.8296 acc=0.5000
[Server] Round 11 global metrics: loss=0.8296

[Server] Round 12/20 | selected=['1']
[Client1] Final: loss=1.2740 acc=0.5000
[Server] Round 12 global metrics: loss=1.2740

[Server] Round 13/20 | selected=['1']
[Client1] Final: loss=0.9494 acc=0.5000
[Server] Round 13 global metrics: loss=0.9494

[Server] Round 14/20 | selected=['1']
[Client1] Final: loss=0.5695 acc=0.5000
[Server] Round 14 global metrics: loss=0.5695

[Server] Round 15/20 | selected=['1']
[Client1] Final: loss=0.9121 acc=0.5000
[Server] Round 15 global metrics: loss=0.9121

[Server] Round 16/20 | selected=['1']
[Client1] Final: loss=1.2657 acc=0.5000
[Server] Round 16 global metrics: loss=1.2657

[Server] Round 17/20 | selected=['1']
[Client1] Final: loss=0.3603 acc=1.0000
[Server] Round 17 global metrics: loss=0.3603

[Server] Round 18/20 | selected=['1']
[Client1] Final: loss=1.1633 acc=0.5000
[Server] Round 18 global metrics: loss=1.1633

[Server] Round 19/20 | selected=['1']
[Client1] Final: loss=0.7140 acc=0.7500
[Server] Round 19 global metrics: loss=0.7140

[Server] Round 20/20 | selected=['1']
[Client1] Final: loss=0.2916 acc=0.7500
[Server] Round 20 global metrics: loss=0.2916

[Server] 训练完成！最终模型已保存到: FedVideomae_DP/runs/linear_probe_rwf2000/model_final.pth

=== Final Model Evaluation ===
Accuracy: 0.5856
Precision (Weighted): 0.6038
Recall (Weighted): 0.5856
F1-Score (Weighted): 0.5666
Precision (Macro): 0.6038
Recall (Macro): 0.5856
F1-Score (Macro): 0.5666
ROC-AUC: 0.6780
Average Precision: 0.6612

Confusion Matrix:
         Predicted
         NonFight  Fight
Actual NonFight    636    164
       Fight        499    301