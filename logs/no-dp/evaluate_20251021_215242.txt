=== Task: evaluate ===
timestamp: 20251021_215242
config:
experiment: evaluate_small_head_rwf2000
output_dir: FedVideomae_DP/evaluation_results/small_head_rwf2000
seed: 42
data:
  root: FedVideomae_DP/dataset/RWF-2000/evaluate
  num_frames: 16
  frame_stride: 4
  size: 224
  batch_size: 32
  num_workers: 8
  partitions: null
model:
  model_name: MCG-NJU/videomae-base
  pretrained: false
  pretrained_checkpoint: FedVideomae_DP/runs/central_weak_finetune_rwf2000_no_dp/model_best.pth
  mode: head
  peft:
    use_lora: true
    lora_r: 16
    lora_alpha: 32
    lora_dropout: 0.12
    target_modules:
    - q_proj
    - k_proj
    - v_proj
    - out_proj
    - fc1
    - fc2
  head:
    num_classes: 2
    type: mlp
    hidden_dim: 1536
    num_layers: 2
    dropout: 0.2
logging:
  log_every: 20
[Init] Using pretrained checkpoint: FedVideomae_DP/runs/central_weak_finetune_rwf2000_no_dp/model_best.pth | sha256=891e7bde990871ad
metrics:
accuracy: 0.7725
precision_weighted: 0.7731
recall_weighted: 0.7725
f1_weighted: 0.7724
precision_macro: 0.7731
recall_macro: 0.7725
f1_macro: 0.7724
correct: 309/400

[ApplyBestThreshold] Re-evaluating with threshold=0.64
Evaluating classification: 100%|████████████████████████████████████| 400/400 [04:13<00:00,  1.58samples/s, Accuracy=0.7725, Correct=309/400]

=== Classification Performance Metrics ===
Accuracy: 0.7725
Correct: 309/400
Precision (Weighted): 0.7731
Recall (Weighted): 0.7725
F1-Score (Weighted): 0.7724
Precision (Macro): 0.7731
Recall (Macro): 0.7725
F1-Score (Macro): 0.7724

=== Per-Class Metrics ===
NonFight:
  Precision: 0.7853
  Recall: 0.7500
  F1-Score: 0.7673
  Support: 200
Fight:
  Precision: 0.7608
  Recall: 0.7950
  F1-Score: 0.7775
  Support: 200

=== Confusion Matrix ===
         Predicted
         NonFight  Fight
Actual NonFight    150     50
       Fight         41    159
